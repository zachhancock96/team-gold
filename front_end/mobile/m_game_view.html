<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game View</title>
    <link rel='stylesheet' href='../css/style.css' />
    <link rel='stylesheet' href="../css/mobile.css" />
    <link href='https://use.fontawesome.com/releases/v5.0.6/css/all.css' rel='stylesheet'>
    <link href='https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css' rel='stylesheet' />
    <link href='../fullcalendar/core/main.css' rel='stylesheet' />
    <link href='../fullcalendar/daygrid/main.css' rel='stylesheet' />
    <link href='../fullcalendar/timegrid/main.css' rel='stylesheet' />
    <link href='../fullcalendar/list/main.css' rel='stylesheet' />

    <script src='../fullcalendar/core/main.js'></script>
    <script src='../fullcalendar/interaction/main.js'></script>
    <script src='../fullcalendar/daygrid/main.js'></script>
    <script src='../fullcalendar/timegrid/main.js'></script>
    <script src='../fullcalendar/list/main.js'></script>
    <script src='../js/jquery.js'></script>
    <script src='../js/api.js'></script>
    <script>

        // set menu to hidden
        var menuState='hidden';

        function changeNav(){

            if(menuState == 'hidden'){
                document.getElementById('mySidebar').style.width='250px';
                menuState='visible';
            }

            else{
                document.getElementById('mySidebar').style.width='0';
                menuState='hidden';
            }
        }

        //html is loaded
      document.addEventListener('DOMContentLoaded', calendarGames);
      
      function calendarGames() {
  
          //fetch games
        api.getGames().then(function(games){
          const gamesF = games.filter(mySchoolFunction);
          
          //render calendar
          var calendarEl = document.getElementById('calendar');
          var todayDate = new Date();
          var calendar = new FullCalendar.Calendar(calendarEl, {
            plugins: [ 'interaction', 'dayGrid', 'timeGrid', 'list' ],
            header: {
            left: 'prev,next today',
            center: 'title',
            right: 'dayGridMonth,timeGridWeek,timeGridDay,listWeek'
            },
            defaultDate: todayDate,
            editable: true,
            navLinks: true, // can click day/week names to navigate views
            eventLimit: true, // allow "more" link when too many events
            events: gamesF
            });

            calendar.render();
        })
  
        }

  
      </script>
</head>
<body>

    <div id='mySidebar' class='sidebar'>
        <a href='./m_game_view.html'>View Games</a>
        <a href='./m_add_single_game.html'>Add Game Manually</a>
        <a href='#ccc'>Upload Schedule</a>
        <a href='./m_verify_games.html'>Verify Games</a>
        <a href='./m_school_profile.html'>Edit School Profile</a>
        <a href='./m_user_profile.html'>Edit User Profile</a>
    </div>

    <div id='sideBtn'>
        <button class='openbtn' onclick='changeNav()'>&#9776; Menu</button>
    </div>

    <header>
        Game View
    </header>
	

  <!--
    Filter games
  -->

  <input type="text" id="schoolName" placeholder="Search for school..." title="school">
  
  <!--
  <input type="text" id="teamName" onkeyup="myteamFunction()" placeholder="Search for team..." title="team">
  <input type="text" id="genderName" onkeyup="mygenderFunction()" placeholder="Search for boys/girls..." title="gender">
  -->
  <button id="myBtn">Apply Filter</button>
  <script>
    document.getElementById("myBtn").addEventListener("click", calendarGames);
    
    function mySchoolFunction(gameN) {
      var input, filter, txtValue, i, a;
      input = document.getElementById('schoolName');
      filter = input.value.toUpperCase();
      a = gameN.title;
      txtValue = a.textContent || a.innerText;
      if(a.toUpperCase().indexOf(filter) > -1){
        return true;
      }
    }
  </script>
    <!--
        Show the calendar of games that have been added
    -->

    
    
      <div id='calendar'></div>
</body>
</html>